# PathoNet
Реализация модели PathoNet для детекции и классификации клеток на гистологических снимках молочной железы

PathoNet представляет собой самостоятельный “backend” глубокого обучения, спроектированный специально для детекции и классификации клеток (Ki-67 положительных/отрицательных опухолевых клеток и TILs) на гистопатологических изображениях. Модель построена по схеме «энкодер–декодер» в стиле U-Net с использованием  **Residual Dual-Inception Module (RDIM)** — собственной вариации Inception-модуля с остаточными соединениями, позволяющей эффективно извлекать многомасштабные признаки при ограниченном числе параметров 

Основным достоинством PathoNet является баланс между точностью и вычислительной эффективностью: при количестве параметров ≈3.14 млн модель обеспечивает FPS ≈14.36 и превосходит другие бэкенды по средней F1-мере (0.785)

## Cхема работы (U-Net-подобный энкодер–декодер)

### Энкодер

* Состоит из нескольких уровней, каждый из которых включает **RDIM** — модуль с параллельными ветвями свёрток разного размера ядра и последующим объединением ([paperswithcode.com][3]).
* После объединения результата модуля применяется **batch-нормализация** и **ReLU**-активация.
* На каждом уровне число каналов постепенно увеличивается (e.g. 64 → 128 → 256), что позволяет извлекать всё более абстрактные признаки ([ar5iv][1]).

### Декодер

* Зеркальная структура энкодера: каждый уровень начинается с **транспонированной свёртки** (up-sampling), уменьшающей число каналов.
* Результат up-sampling конкатенируется с соответствующим по глубине выходом энкодера через **skip-connection**, что сохраняет мелкомасштабные детали изображения ([ResearchGate][2]).
* Затем снова применяется **Residual Dual-Inception Module** и активации.

## Residual Dual-Inception Module (RDIM)

* **Две параллельные ветви**: свёртки 3×3 и 5×5 (либо их эквиваленты через dilated-конволюции), а также максимальная пулинг-ветвь, сжимаемая 1×1 свёрткой ([paperswithcode.com][3]).
* Выходы ветвей конкатенируются и пропускаются через 1×1 свёртку для выравнивания числа каналов.
* Вводное остаточное соединение (skip-connection) добавляет исходный тензор к выходу модуля, что уменьшает риск затухания градиента и ускоряет сходимость ([ar5iv][1]).


Оригинальная статья авторов доступна по ссылке:
– **Scientific Reports**: [https://doi.org/10.1038/s41598-021-86912-w](https://doi.org/10.1038/s41598-021-86912-w)
– **arXiv-препринт**: [https://arxiv.org/abs/2010.04713](https://arxiv.org/abs/2010.04713)
